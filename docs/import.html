<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 5 Importing Data | eBird Best Practices I</title>
  <meta name="description" content="Lesson 5 Importing Data | eBird Best Practices I: eBird Data Extraction and Processing in R" />
  <meta name="generator" content="bookdown 0.11.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 5 Importing Data | eBird Best Practices I" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lesson 5 Importing Data | eBird Best Practices I: eBird Data Extraction and Processing in R" />
  <meta name="github-repo" content="mstrimas/ebp-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 5 Importing Data | eBird Best Practices I" />
  
  <meta name="twitter:description" content="Lesson 5 Importing Data | eBird Best Practices I: eBird Data Extraction and Processing in R" />
  

<meta name="author" content="Matthew Strimas-Mackey, Alison Johnston, Wesley M. Hochachka, Viviana Ruiz-Gutierrez, Orin J. Robinson, Eliot T. Miller, Tom Auer, Steve Kelling, Daniel Fink" />


<meta name="date" content="2019-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="filter.html">
<link rel="next" href="presabs.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">eBird Best Practices Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup</a><ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#setup-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="access.html"><a href="access.html"><i class="fa fa-check"></i><b>3</b> Data Access</a></li>
<li class="chapter" data-level="4" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>4</b> Filtering</a><ul>
<li class="chapter" data-level="4.1" data-path="filter.html"><a href="filter.html#filter-define"><i class="fa fa-check"></i><b>4.1</b> Defining filters</a><ul>
<li class="chapter" data-level="4.1.1" data-path="filter.html"><a href="filter.html#filter-define-complete"><i class="fa fa-check"></i><b>4.1.1</b> Complete checklists</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="filter.html"><a href="filter.html#filter-execute"><i class="fa fa-check"></i><b>4.2</b> Execute filters</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>5</b> Importing Data</a><ul>
<li class="chapter" data-level="5.1" data-path="import.html"><a href="import.html#import-group"><i class="fa fa-check"></i><b>5.1</b> Group checklists</a></li>
<li class="chapter" data-level="5.2" data-path="import.html"><a href="import.html#import-taxonomy"><i class="fa fa-check"></i><b>5.2</b> Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="presabs.html"><a href="presabs.html"><i class="fa fa-check"></i><b>6</b> Presence-absence Data</a><ul>
<li class="chapter" data-level="6.1" data-path="presabs.html"><a href="presabs.html#presabs-filter"><i class="fa fa-check"></i><b>6.1</b> Filtering</a></li>
<li class="chapter" data-level="6.2" data-path="presabs.html"><a href="presabs.html#presabs-zerofill"><i class="fa fa-check"></i><b>6.2</b> Zero-filling</a></li>
<li class="chapter" data-level="6.3" data-path="presabs.html"><a href="presabs.html#presabs-tidy"><i class="fa fa-check"></i><b>6.3</b> Tidying up</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>7</b> Applications</a><ul>
<li class="chapter" data-level="7.1" data-path="applications.html"><a href="applications.html#applications-trajectory"><i class="fa fa-check"></i><b>7.1</b> Frequency trajectories</a></li>
<li class="chapter" data-level="7.2" data-path="applications.html"><a href="applications.html#applications-maps"><i class="fa fa-check"></i><b>7.2</b> Maps</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>8</b> Advanced Topics</a><ul>
<li class="chapter" data-level="8.1" data-path="advanced.html"><a href="advanced.html#advanced-custom"><i class="fa fa-check"></i><b>8.1</b> Custom downloads</a></li>
<li class="chapter" data-level="8.2" data-path="advanced.html"><a href="advanced.html#advanced-unmarked"><i class="fa fa-check"></i><b>8.2</b> Preparing for occupancy modeling</a></li>
<li class="chapter" data-level="8.3" data-path="advanced.html"><a href="advanced.html#advanced-modis"><i class="fa fa-check"></i><b>8.3</b> Land cover covariates</a></li>
<li class="chapter" data-level="8.4" data-path="advanced.html"><a href="advanced.html#advanced-multi"><i class="fa fa-check"></i><b>8.4</b> Dealing with multiple species</a></li>
<li class="chapter" data-level="8.5" data-path="advanced.html"><a href="advanced.html#advanced-size"><i class="fa fa-check"></i><b>8.5</b> Reducing file size</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">eBird Best Practices I</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="import" class="section level1">
<h1><span class="header-section-number">Lesson 5</span> Importing Data</h1>
<p>In the previous lesson we extracted a subset of the EBD containing Yellow-rumped Warbler observations from Guatemala. The output file created by <code>auk_filter()</code> is a tab-seperated text file and could be read into using <code>read.delim()</code> or <code>readr::read_tsv()</code>; however, <code>auk</code> has a function specifically for reading the EBD. <code>read_ebd()</code> does the following:</p>
<ol style="list-style-type: decimal">
<li>Reads the data using <code>data.table::fread()</code>, which is much faster than <code>read.delim()</code>.</li>
<li>Sets the correct variable types.</li>
<li>Cleans up the column names so they are all <code>snake_case</code>.</li>
<li>Automatically performs some post processing steps, which will be covered later in this lesson.</li>
</ol>
<p>Letâ€™s read in the data!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(auk)
<span class="kw">library</span>(dplyr)

ebd &lt;-<span class="st"> </span><span class="kw">read_ebd</span>(<span class="st">&quot;data/ebd_yerwar.txt&quot;</span>, <span class="dt">unique =</span> <span class="ot">FALSE</span>, <span class="dt">rollup =</span> <span class="ot">FALSE</span>)
<span class="kw">glimpse</span>(ebd)
<span class="co">#&gt; Observations: 276</span>
<span class="co">#&gt; Variables: 46</span>
<span class="co">#&gt; $ global_unique_identifier     [3m[90m&lt;chr&gt;[39m[23m &quot;URN:CornellLabOfOrnithology:EBIRD:â€¦</span>
<span class="co">#&gt; $ last_edited_date             [3m[90m&lt;chr&gt;[39m[23m &quot;2018-09-09 12:17:58&quot;, &quot;2018-09-09 â€¦</span>
<span class="co">#&gt; $ taxonomic_order              [3m[90m&lt;dbl&gt;[39m[23m 31814, 31814, 31814, 31816, 31814, â€¦</span>
<span class="co">#&gt; $ category                     [3m[90m&lt;chr&gt;[39m[23m &quot;species&quot;, &quot;species&quot;, &quot;species&quot;, &quot;iâ€¦</span>
<span class="co">#&gt; $ common_name                  [3m[90m&lt;chr&gt;[39m[23m &quot;Yellow-rumped Warbler&quot;, &quot;Yellow-ruâ€¦</span>
<span class="co">#&gt; $ scientific_name              [3m[90m&lt;chr&gt;[39m[23m &quot;Setophaga coronata&quot;, &quot;Setophaga coâ€¦</span>
<span class="co">#&gt; $ subspecies_common_name       [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, &quot;Yellow-rumped Warbler â€¦</span>
<span class="co">#&gt; $ subspecies_scientific_name   [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, &quot;Setophaga coronata audâ€¦</span>
<span class="co">#&gt; $ observation_count            [3m[90m&lt;chr&gt;[39m[23m &quot;8&quot;, &quot;8&quot;, &quot;8&quot;, &quot;1&quot;, &quot;10&quot;, &quot;1&quot;, &quot;10&quot;â€¦</span>
<span class="co">#&gt; $ breeding_bird_atlas_code     [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ breeding_bird_atlas_category [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ age_sex                      [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ country                      [3m[90m&lt;chr&gt;[39m[23m &quot;Guatemala&quot;, &quot;Guatemala&quot;, &quot;Guatemalâ€¦</span>
<span class="co">#&gt; $ country_code                 [3m[90m&lt;chr&gt;[39m[23m &quot;GT&quot;, &quot;GT&quot;, &quot;GT&quot;, &quot;GT&quot;, &quot;GT&quot;, &quot;GT&quot;,â€¦</span>
<span class="co">#&gt; $ state                        [3m[90m&lt;chr&gt;[39m[23m &quot;Baja Verapaz&quot;, &quot;Baja Verapaz&quot;, &quot;Baâ€¦</span>
<span class="co">#&gt; $ state_code                   [3m[90m&lt;chr&gt;[39m[23m &quot;GT-BV&quot;, &quot;GT-BV&quot;, &quot;GT-BV&quot;, &quot;GT-AV&quot;,â€¦</span>
<span class="co">#&gt; $ county                       [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ county_code                  [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ iba_code                     [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ bcr_code                     [3m[90m&lt;int&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ usfws_code                   [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ atlas_block                  [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ locality                     [3m[90m&lt;chr&gt;[39m[23m &quot;Finca Santo Tomas&quot;, &quot;Finca Santo Tâ€¦</span>
<span class="co">#&gt; $ locality_id                  [3m[90m&lt;chr&gt;[39m[23m &quot;L3244964&quot;, &quot;L3244964&quot;, &quot;L3244964&quot;,â€¦</span>
<span class="co">#&gt; $ locality_type                [3m[90m&lt;chr&gt;[39m[23m &quot;P&quot;, &quot;P&quot;, &quot;P&quot;, &quot;H&quot;, &quot;H&quot;, &quot;H&quot;, &quot;H&quot;, â€¦</span>
<span class="co">#&gt; $ latitude                     [3m[90m&lt;dbl&gt;[39m[23m 15.2, 15.2, 15.2, 15.2, 15.2, 15.2,â€¦</span>
<span class="co">#&gt; $ longitude                    [3m[90m&lt;dbl&gt;[39m[23m -90.3, -90.3, -90.3, -90.3, -90.3, â€¦</span>
<span class="co">#&gt; $ observation_date             [3m[90m&lt;date&gt;[39m[23m 2015-12-26, 2015-12-26, 2015-12-26â€¦</span>
<span class="co">#&gt; $ time_observations_started    [3m[90m&lt;chr&gt;[39m[23m &quot;14:26:00&quot;, &quot;14:26:00&quot;, &quot;14:26:00&quot;,â€¦</span>
<span class="co">#&gt; $ observer_id                  [3m[90m&lt;chr&gt;[39m[23m &quot;obsr414683&quot;, &quot;obsr418529&quot;, &quot;obsr41â€¦</span>
<span class="co">#&gt; $ sampling_event_identifier    [3m[90m&lt;chr&gt;[39m[23m &quot;S26466410&quot;, &quot;S26466240&quot;, &quot;S2646791â€¦</span>
<span class="co">#&gt; $ protocol_type                [3m[90m&lt;chr&gt;[39m[23m &quot;Stationary&quot;, &quot;Stationary&quot;, &quot;Statioâ€¦</span>
<span class="co">#&gt; $ protocol_code                [3m[90m&lt;chr&gt;[39m[23m &quot;P21&quot;, &quot;P21&quot;, &quot;P21&quot;, &quot;P22&quot;, &quot;P21&quot;, â€¦</span>
<span class="co">#&gt; $ project_code                 [3m[90m&lt;chr&gt;[39m[23m &quot;EBIRD&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;,â€¦</span>
<span class="co">#&gt; $ duration_minutes             [3m[90m&lt;int&gt;[39m[23m 15, 15, 15, 68, 15, 68, 15, 15, 120â€¦</span>
<span class="co">#&gt; $ effort_distance_km           [3m[90m&lt;dbl&gt;[39m[23m NA, NA, NA, 7.00, NA, 7.00, NA, NA,â€¦</span>
<span class="co">#&gt; $ effort_area_ha               [3m[90m&lt;dbl&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ number_observers             [3m[90m&lt;int&gt;[39m[23m 3, 3, 3, 3, 3, 3, 3, 3, 4, 1, 1, 5,â€¦</span>
<span class="co">#&gt; $ all_species_reported         [3m[90m&lt;lgl&gt;[39m[23m TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,â€¦</span>
<span class="co">#&gt; $ group_identifier             [3m[90m&lt;chr&gt;[39m[23m &quot;G1514667&quot;, &quot;G1514667&quot;, &quot;G1514667&quot;,â€¦</span>
<span class="co">#&gt; $ has_media                    [3m[90m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, FALSE, â€¦</span>
<span class="co">#&gt; $ approved                     [3m[90m&lt;lgl&gt;[39m[23m TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,â€¦</span>
<span class="co">#&gt; $ reviewed                     [3m[90m&lt;lgl&gt;[39m[23m FALSE, FALSE, FALSE, FALSE, FALSE, â€¦</span>
<span class="co">#&gt; $ reason                       [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span>
<span class="co">#&gt; $ trip_comments                [3m[90m&lt;chr&gt;[39m[23m &quot;&lt;br /&gt;Enviado desde eBird Android â€¦</span>
<span class="co">#&gt; $ species_comments             [3m[90m&lt;chr&gt;[39m[23m NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦</span></code></pre>
<p>Weâ€™ll cover the use of <code>unique = FALSE</code> and <code>rollup = FALSE</code> next. For now, letâ€™s just look at the data.</p>
<div class="exercise">
<h2>
Exercise
</h2>
<p>Take a minute to explore these data using <code>glimpse()</code> and <code>View()</code>. Familiarize yourself with the columns.</p>
</div>
<div class="checkpoint">
<h2>
Checkpoint
</h2>
<p>Do you have the data in a data frame? Does anyone have any questions about the data so far?</p>
</div>
<div id="import-group" class="section level2">
<h2><span class="header-section-number">5.1</span> Group checklists</h2>
<p>eBird allows users to share checklists with other eBird users that theyâ€™re birding with. This results it multiple copies of some checklists in the database. Group checklists can be identified in the data because they have the <code>group_identifier</code> populated. Letâ€™s take a look at these checklists.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(ebd, <span class="op">!</span><span class="kw">is.na</span>(group_identifier)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(sampling_event_identifier, group_identifier) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>()
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   sampling_event_identifier group_identifier</span>
<span class="co">#&gt;   &lt;chr&gt;                     &lt;chr&gt;           </span>
<span class="co">#&gt; 1 S26466410                 G1514667        </span>
<span class="co">#&gt; 2 S26466240                 G1514667        </span>
<span class="co">#&gt; 3 S26467913                 G1514667        </span>
<span class="co">#&gt; 4 S26033869                 G1480977        </span>
<span class="co">#&gt; 5 S26467907                 G1514670        </span>
<span class="co">#&gt; 6 S26064931                 G1480977</span></code></pre>
<p>We see that there are multiple checklists with the same <code>group_identifier</code>, implying that these checklists have been shared and are duplicates. Letâ€™s look at one of these on the eBird website: <a href="https://ebird.org/view/checklist/S26466410" class="uri">https://ebird.org/view/checklist/S26466410</a></p>
<p>As it turns out, group checklists arenâ€™t exact duplicates; once a checklist has been shared the individual checklists can diverge in terms of the species seen, the counts for each species, and even the protocol and effort.</p>
<p>In most cases, youâ€™ll only want to retain one of these checklists, but itâ€™s not trivial to do so because the checklists are only partial duplicates. The function <code>auk_unique()</code> manages this for you. Specifically, for each species, it retains only the first observation of that species, which is typically the one submitted by the primary observer (i.e.Â the person who recorded the original checklist).</p>
<pre class="sourceCode r"><code class="sourceCode r">keep_one &lt;-<span class="st"> </span><span class="kw">filter</span>(ebd, group_identifier <span class="op">==</span><span class="st"> &quot;G1480977&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">auk_unique</span>()</code></pre>
<p>Note that a new field has been created (<code>checklist_id</code>), which is populated with <code>group_identifier</code> for group checklists and <code>sampling_event_identifier</code> otherwise; this is now a unique identifier for checklists. In addition, the full set of observer and sampling event identifiers has been retained in a comma seperated format.</p>
<p>By default, <code>read_ebd()</code> calls <code>auk_unique()</code> automatically; however, this behaviour can be controlled with the <code>unique</code> argument.</p>
<pre class="sourceCode r"><code class="sourceCode r">ebd &lt;-<span class="st"> </span><span class="kw">read_ebd</span>(<span class="st">&quot;data/ebd_yerwar.txt&quot;</span>, <span class="dt">rollup =</span> <span class="ot">FALSE</span>)</code></pre>
<div class="tip">
<h2>
Tip
</h2>
<p><code>auk_unique()</code> takes a long time to run on large datasets. Consider using <code>read_ebd(unique = FALSE)</code> when importing large text files to prevent R from freezing.</p>
</div>
</div>
<div id="import-taxonomy" class="section level2">
<h2><span class="header-section-number">5.2</span> Taxonomy</h2>
<p>eBird users can enter data for a wide range of taxa in addition to species. Observations can be reported at a level more granular than species (e.g.Â subspecies or recognizable forms) or at a higher level than species (e.g.Â spuhs, slashes, and hybrids). All the different taxa that can be reported are contains in the eBird taxonomy, which is updated every year in August. The eBird Science page has a <a href="https://ebird.org/science/the-ebird-taxonomy">subsection with details on the eBir</a> taxonomy and the taxonomy itself is available in the package as a dataframe in the <code>auk</code> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(ebird_taxonomy)
<span class="co">#&gt; Observations: 16,248</span>
<span class="co">#&gt; Variables: 8</span>
<span class="co">#&gt; $ scientific_name &lt;chr&gt; &quot;Struthio camelus&quot;, &quot;Struthio molybdophanes&quot;, &quot;Sâ€¦</span>
<span class="co">#&gt; $ common_name     &lt;chr&gt; &quot;Common Ostrich&quot;, &quot;Somali Ostrich&quot;, &quot;Common/Somaâ€¦</span>
<span class="co">#&gt; $ species_code    &lt;chr&gt; &quot;ostric2&quot;, &quot;ostric3&quot;, &quot;y00934&quot;, &quot;grerhe1&quot;, &quot;lesrâ€¦</span>
<span class="co">#&gt; $ category        &lt;chr&gt; &quot;species&quot;, &quot;species&quot;, &quot;slash&quot;, &quot;species&quot;, &quot;speciâ€¦</span>
<span class="co">#&gt; $ taxon_order     &lt;dbl&gt; 1, 6, 7, 8, 14, 15, 18, 19, 20, 21, 26, 27, 30, â€¦</span>
<span class="co">#&gt; $ order           &lt;chr&gt; &quot;Struthioniformes&quot;, &quot;Struthioniformes&quot;, &quot;Struthiâ€¦</span>
<span class="co">#&gt; $ family          &lt;chr&gt; &quot;Struthionidae&quot;, &quot;Struthionidae&quot;, &quot;Struthionidaeâ€¦</span>
<span class="co">#&gt; $ report_as       &lt;chr&gt; NA, NA, NA, NA, NA, &quot;lesrhe2&quot;, &quot;lesrhe2&quot;, NA, NAâ€¦</span></code></pre>
<p>Note that for taxa below the species level, the <code>report_as</code> field specifies the species that this taxa falls under. The EBD contains a subspecies column which is populated when an observer has identified a bird below species level. In the EBD extract weâ€™re working with, we have three different subspecies of Yellow-rumped Warbler:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">count</span>(ebd, common_name, subspecies_common_name)
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   common_name           subspecies_common_name                n</span>
<span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt;                             &lt;int&gt;</span>
<span class="co">#&gt; 1 Yellow-rumped Warbler &lt;NA&gt;                                 59</span>
<span class="co">#&gt; 2 Yellow-rumped Warbler Yellow-rumped Warbler (Audubon&#39;s)    38</span>
<span class="co">#&gt; 3 Yellow-rumped Warbler Yellow-rumped Warbler (Goldman&#39;s)    14</span>
<span class="co">#&gt; 4 Yellow-rumped Warbler Yellow-rumped Warbler (Myrtle)       12</span></code></pre>
<p>Itâ€™s even possible to have multiple subspecies of the same species on a single checklist.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(ebd, checklist_id <span class="op">==</span><span class="st"> &quot;S22725024&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(checklist_id, common_name, subspecies_common_name, observation_count)
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   checklist_id common_name       subspecies_common_name    observation_couâ€¦</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;             &lt;chr&gt;                     &lt;chr&gt;           </span>
<span class="co">#&gt; 1 S22725024    Yellow-rumped Waâ€¦ Yellow-rumped Warbler (Mâ€¦ 1               </span>
<span class="co">#&gt; 2 S22725024    Yellow-rumped Waâ€¦ Yellow-rumped Warbler (Aâ€¦ 1</span></code></pre>
<p>For most uses, youâ€™ll want eBird data at the species level, which means dropping higher level taxa and rolling lower level taxa up to species level, making sure to sum the counts if multiple subspecies were present. The function <code>auk_rollup()</code> handles these taxonomic matters for you.</p>
<pre class="sourceCode r"><code class="sourceCode r">no_subsp &lt;-<span class="st"> </span><span class="kw">auk_rollup</span>(ebd)
<span class="kw">filter</span>(no_subsp, checklist_id <span class="op">==</span><span class="st"> &quot;S22725024&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(checklist_id, common_name, observation_count)
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   checklist_id common_name           observation_count</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;                 &lt;chr&gt;            </span>
<span class="co">#&gt; 1 S22725024    Yellow-rumped Warbler 2</span></code></pre>
<p>By default, <code>read_ebd()</code> calls <code>auk_rollup()</code> automatically; however, this behaviour can be controlled with the <code>rollup</code> argument.</p>
<pre class="sourceCode r"><code class="sourceCode r">ebd &lt;-<span class="st"> </span><span class="kw">read_ebd</span>(<span class="st">&quot;data/ebd_yerwar.txt&quot;</span>)</code></pre>
<div class="checkpoint">
<h2>
Checkpoint
</h2>
<p>Any questions on data import, taxonomy, or group checklists?</p>
</div>

</div>
</div>
<script>
var coll = document.getElementsByClassName("solution");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>
            </section>

          </div>
        </div>
      </div>
<a href="filter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="presabs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mstrimas/ebp-workshop/edit/master/05_import.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
